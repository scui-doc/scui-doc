"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[2798,1200],{25201:function(e,l,t){t.r(l),t.d(l,{default:function(){return y}});var i=t(66252),s=t(3577);const a=e=>((0,i.dD)("data-v-62f249e9"),e=e(),(0,i.Cn)(),e),n=a((()=>(0,i._)("h4",null,"执行类",-1))),d=a((()=>(0,i._)("h4",null,"定时规则",-1))),o={class:"bottom"},u={class:"state"},c=(0,i.Uk)("准备就绪"),r=(0,i.Uk)("停用"),m={class:"handler"},p=(0,i.Uk)("编辑"),f=(0,i.Uk)("日志"),g=(0,i.Uk)("删除"),w=a((()=>(0,i._)("p",null,"添加计划任务",-1)));function h(e,l,t,a,h,k){const _=(0,i.up)("el-tag"),v=(0,i.up)("el-button"),W=(0,i.up)("el-popconfirm"),C=(0,i.up)("el-dropdown-item"),y=(0,i.up)("el-dropdown-menu"),b=(0,i.up)("el-dropdown"),D=(0,i.up)("el-card"),x=(0,i.up)("el-col"),U=(0,i.up)("el-icon-plus"),$=(0,i.up)("el-icon"),V=(0,i.up)("el-row"),z=(0,i.up)("el-main"),j=(0,i.up)("save-dialog"),H=(0,i.up)("logs"),S=(0,i.up)("el-drawer");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(V,{gutter:15},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(h.list,(e=>((0,i.wg)(),(0,i.j4)(x,{xl:6,lg:6,md:8,sm:12,xs:24,key:e.id},{default:(0,i.w5)((()=>[(0,i.Wm)(D,{class:"task task-item",shadow:"hover"},{default:(0,i.w5)((()=>[(0,i._)("h2",null,(0,s.zw)(e.title),1),(0,i._)("ul",null,[(0,i._)("li",null,[n,(0,i._)("p",null,(0,s.zw)(e.handler),1)]),(0,i._)("li",null,[d,(0,i._)("p",null,(0,s.zw)(e.cron),1)])]),(0,i._)("div",o,[(0,i._)("div",u,["1"==e.state?((0,i.wg)(),(0,i.j4)(_,{key:0,size:"small"},{default:(0,i.w5)((()=>[c])),_:1})):(0,i.kq)("",!0),"-1"==e.state?((0,i.wg)(),(0,i.j4)(_,{key:1,size:"small",type:"info"},{default:(0,i.w5)((()=>[r])),_:1})):(0,i.kq)("",!0)]),(0,i._)("div",m,[(0,i.Wm)(W,{title:"确定立即执行吗？",onConfirm:l=>k.run(e)},{reference:(0,i.w5)((()=>[(0,i.Wm)(v,{type:"primary",icon:"el-icon-caret-right",circle:""})])),_:2},1032,["onConfirm"]),(0,i.Wm)(b,{trigger:"click"},{dropdown:(0,i.w5)((()=>[(0,i.Wm)(y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(C,{onClick:l=>k.edit(e)},{default:(0,i.w5)((()=>[p])),_:2},1032,["onClick"]),(0,i.Wm)(C,{onClick:l=>k.logs(e)},{default:(0,i.w5)((()=>[f])),_:2},1032,["onClick"]),(0,i.Wm)(C,{onClick:l=>k.del(e),divided:""},{default:(0,i.w5)((()=>[g])),_:2},1032,["onClick"])])),_:2},1024)])),default:(0,i.w5)((()=>[(0,i.Wm)(v,{type:"primary",icon:"el-icon-more",circle:"",plain:""})])),_:2},1024)])])])),_:2},1024)])),_:2},1024)))),128)),(0,i.Wm)(x,{xl:6,lg:6,md:8,sm:12,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(D,{class:"task task-add",shadow:"none",onClick:k.add},{default:(0,i.w5)((()=>[(0,i.Wm)($,null,{default:(0,i.w5)((()=>[(0,i.Wm)(U)])),_:1}),w])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),h.dialog.save?((0,i.wg)(),(0,i.j4)(j,{key:0,ref:"saveDialog",onSuccess:k.handleSuccess,onClosed:l[0]||(l[0]=e=>h.dialog.save=!1)},null,8,["onSuccess"])):(0,i.kq)("",!0),(0,i.Wm)(S,{title:"计划任务日志",modelValue:h.dialog.logsVisible,"onUpdate:modelValue":l[1]||(l[1]=e=>h.dialog.logsVisible=e),size:600,direction:"rtl","destroy-on-close":""},{default:(0,i.w5)((()=>[(0,i.Wm)(H)])),_:1},8,["modelValue"])],64)}var k=t(43048),_=t(31027),v={name:"task",components:{saveDialog:k["default"],logs:_["default"]},provide(){return{list:this.list}},data(){return{dialog:{save:!1,logsVisible:!1},list:[{id:"1",title:"清理服务器缓存",handler:"cleanUpCacheHandler",cron:"59 59 23 * * ? *",state:"1"},{id:"2",title:"自动审核",handler:"automaticAuditHandler",cron:"0 0 * * * ? *",state:"1"},{id:"3",title:"清理未实名用户",handler:"deleteUserHandler",cron:"0 0 0 * * ? *",state:"-1"}]}},mounted(){},methods:{add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open()}))},edit(e){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(e)}))},del(e){this.$confirm(`确认删除 ${e.title} 计划任务吗？`,"提示",{type:"warning",confirmButtonText:"删除",confirmButtonClass:"el-button--danger"}).then((()=>{this.list.splice(this.list.findIndex((l=>l.id===e.id)),1)})).catch((()=>{}))},logs(){this.dialog.logsVisible=!0},run(e){this.$message.success(`已成功执行计划任务：${e.title}`)},handleSuccess(e,l){"add"==l?(e.id=(new Date).getTime(),this.list.push(e)):"edit"==l&&this.list.filter((l=>l.id===e.id)).forEach((l=>{Object.assign(l,e)}))}}},W=t(83744);const C=(0,W.Z)(v,[["render",h],["__scopeId","data-v-62f249e9"]]);var y=C}}]);