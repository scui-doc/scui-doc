(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3f85ab0f"],{"84c1":function(e,t,c){"use strict";c.r(t);c("ac1f"),c("841c"),c("b0c0"),c("caad"),c("2532");var l=c("7a23"),o=function(e){return Object(l.pushScopeId)("data-v-c1c1a498"),e=e(),Object(l.popScopeId)(),e},n={class:"sc-file-select"},i={class:"sc-file-select__side"},a={class:"sc-file-select__side-menu"},r={class:"el-tree-node__label"},s=o((function(){return Object(l.createElementVNode)("i",{class:"el-icon-folder icon"},null,-1)})),u={key:0,class:"sc-file-select__side-msg"},d=Object(l.createTextVNode)(" 已选择 "),p=Object(l.createTextVNode)(" / "),f=Object(l.createTextVNode)(" 项 "),m={class:"sc-file-select__files"},b={class:"sc-file-select__top"},O={key:0,class:"upload"},j=Object(l.createTextVNode)("本地上传"),g={class:"tips"},h=o((function(){return Object(l.createElementVNode)("i",{class:"el-icon-warning-outline"},null,-1)})),k={class:"keyword"},v={class:"sc-file-select__list"},y={class:"sc-file-select__item__file"},_={class:"sc-file-select__item__upload"},N=["onClick"],x={class:"sc-file-select__item__file"},V={key:0,class:"sc-file-select__item__checkbox"},C=[o((function(){return Object(l.createElementVNode)("i",{class:"el-icon-check"},null,-1)}))],E={key:1,class:"sc-file-select__item__select"},w=[o((function(){return Object(l.createElementVNode)("i",{class:"el-icon-check"},null,-1)}))],P=o((function(){return Object(l.createElementVNode)("div",{class:"sc-file-select__item__box"},null,-1)})),B={key:3,class:"item-file item-file-doc"},S={key:1,class:"sc-icon-file-list-fill",style:{color:"#999"}},z=["title"],D={class:"sc-file-select__pagination"},I={class:"sc-file-select__do"},L=Object(l.createTextVNode)("确 定");var q=c("ade3"),R=c("1da1"),T=(c("96cf"),c("a9e3"),c("a434"),c("c740"),c("d3b7"),c("3ca3"),c("ddb0"),c("2b3d"),c("9861"),c("b680"),c("365c")),U={apiObj:T.a.common.upload,menuApiObj:T.a.common.file.menu,listApiObj:T.a.common.file.list,successCode:200,maxSize:30,max:99,uploadParseData:function(e){return{id:e.data.id,fileName:e.data.fileName,url:e.data.src}},listParseData:function(e){return{rows:e.data.rows,total:e.data.total,msg:e.message,code:e.code}},request:{page:"page",pageSize:"pageSize",keyword:"keyword",menuKey:"groupId"},menuProps:{key:"id",label:"label",children:"children"},fileProps:{key:"id",fileName:"fileName",url:"url"},files:{doc:{icon:"sc-icon-file-word-2-fill",color:"#409eff"},docx:{icon:"sc-icon-file-word-2-fill",color:"#409eff"},xls:{icon:"sc-icon-file-excel-2-fill",color:"#67C23A"},xlsx:{icon:"sc-icon-file-excel-2-fill",color:"#67C23A"},ppt:{icon:"sc-icon-file-ppt-2-fill",color:"#F56C6C"},pptx:{icon:"sc-icon-file-ppt-2-fill",color:"#F56C6C"}}},$={props:{modelValue:null,hideUpload:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},max:{type:Number,default:U.max},onlyImage:{type:Boolean,default:!1},maxSize:{type:Number,default:U.maxSize}},data:function(){return{keyword:null,pageSize:20,total:0,currentPage:1,data:[],menu:[],menuId:"",value:this.multiple?[]:"",fileList:[],accept:this.onlyImage?"image/gif, image/jpeg, image/png":"",listLoading:!1,menuLoading:!1,treeProps:U.menuProps,fileProps:U.fileProps,files:U.files}},watch:{multiple:function(){this.value=this.multiple?[]:"",this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))}},mounted:function(){this.getMenu(),this.getData()},methods:{getMenu:function(){var e=this;return Object(R.a)(regeneratorRuntime.mark((function t(){var c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.menuLoading=!0,t.next=3,U.menuApiObj.get();case 3:c=t.sent,e.menu=c.data,e.menuLoading=!1;case 6:case"end":return t.stop()}}),t)})))()},getData:function(){var e=this;return Object(R.a)(regeneratorRuntime.mark((function t(){var c,l,o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.listLoading=!0,c={},Object(q.a)(c,U.request.menuKey,e.menuId),Object(q.a)(c,U.request.page,e.currentPage),Object(q.a)(c,U.request.pageSize,e.pageSize),Object(q.a)(c,U.request.keyword,e.keyword),l=c,e.onlyImage&&(l.type="image"),t.next=5,U.listApiObj.get(l);case 5:o=t.sent,n=U.listParseData(o),e.data=n.rows,e.total=n.total,e.listLoading=!1,e.$refs.scrollbar.setScrollTop(0);case 11:case"end":return t.stop()}}),t)})))()},groupClick:function(e){this.menuId=e.id,this.currentPage=1,this.keyword=null,this.getData()},reload:function(){this.getData()},search:function(){this.currentPage=1,this.getData()},select:function(e){var t=e[this.fileProps.url];this.multiple?this.value.includes(t)?this.value.splice(this.value.findIndex((function(e){return e==t})),1):this.value.push(t):this.value.includes(t)?this.value="":this.value=t},submit:function(){var e=JSON.parse(JSON.stringify(this.value));this.$emit("update:modelValue",e),this.$emit("submit",e)},uploadChange:function(e,t){e.tempImg=URL.createObjectURL(e.raw),this.fileList=t},uploadBefore:function(e){if(!(e.size/1024/1024<this.maxSize))return this.$message.warning("上传文件大小不能超过 ".concat(this.maxSize,"MB!")),!1},uploadRequest:function(e){var t=U.apiObj,c=new FormData;c.append("file",e.file),c.append([U.request.menuKey],this.menuId),t.post(c,{onUploadProgress:function(t){e.onProgress(t)}}).then((function(t){e.onSuccess(t)})).catch((function(t){e.onError(t)}))},uploadProcess:function(e,t){t.progress=Number((e.loaded/e.total*100).toFixed(2))},uploadSuccess:function(e,t){var c;this.fileList.splice(this.fileList.findIndex((function(e){return e.uid==t.uid})),1);var l=U.uploadParseData(e);this.data.unshift((c={},Object(q.a)(c,this.fileProps.key,l.id),Object(q.a)(c,this.fileProps.fileName,l.fileName),Object(q.a)(c,this.fileProps.url,l.url),c)),this.multiple||(this.value=l.url)},uploadError:function(e){this.$notify.error({title:"上传文件错误",message:e})},_isImg:function(e){var t=e.substring(e.lastIndexOf("."));return-1!=[".jpg",".jpeg",".png",".gif",".bmp"].indexOf(t)},_getExt:function(e){return e.substring(e.lastIndexOf(".")+1)}}},A=(c("adcb"),c("6b0d"));const F=c.n(A)()($,[["render",function(e,t,c,o,q,R){var T=Object(l.resolveComponent)("el-tree"),U=Object(l.resolveComponent)("el-button"),$=Object(l.resolveComponent)("el-upload"),A=Object(l.resolveComponent)("el-input"),F=Object(l.resolveComponent)("el-empty"),J=Object(l.resolveComponent)("el-progress"),K=Object(l.resolveComponent)("el-image"),M=Object(l.resolveComponent)("el-scrollbar"),G=Object(l.resolveComponent)("el-pagination"),H=Object(l.resolveDirective)("loading");return Object(l.openBlock)(),Object(l.createElementBlock)("div",n,[Object(l.withDirectives)(Object(l.createElementVNode)("div",i,[Object(l.createElementVNode)("div",a,[Object(l.createVNode)(T,{ref:"group",class:"menu",data:q.menu,"node-key":q.treeProps.key,props:q.treeProps,"current-node-key":q.menu.length>0?q.menu[0][q.treeProps.key]:"","highlight-current":"",onNodeClick:R.groupClick},{default:Object(l.withCtx)((function(e){var t=e.node;return[Object(l.createElementVNode)("span",r,[s,Object(l.createTextVNode)(Object(l.toDisplayString)(t.label),1)])]})),_:1},8,["data","node-key","props","current-node-key","onNodeClick"])]),c.multiple?(Object(l.openBlock)(),Object(l.createElementBlock)("div",u,[d,Object(l.createElementVNode)("b",null,Object(l.toDisplayString)(q.value.length),1),p,Object(l.createElementVNode)("b",null,Object(l.toDisplayString)(c.max),1),f])):Object(l.createCommentVNode)("",!0)],512),[[H,q.menuLoading]]),Object(l.withDirectives)(Object(l.createElementVNode)("div",m,[Object(l.createElementVNode)("div",b,[c.hideUpload?Object(l.createCommentVNode)("",!0):(Object(l.openBlock)(),Object(l.createElementBlock)("div",O,[Object(l.createVNode)($,{class:"sc-file-select__upload",action:"",multiple:"","show-file-list":!1,accept:q.accept,"on-change":R.uploadChange,"before-upload":R.uploadBefore,"on-progress":R.uploadProcess,"on-success":R.uploadSuccess,"on-error":R.uploadError,"http-request":R.uploadRequest},{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(U,{type:"primary",icon:"el-icon-upload2"},{default:Object(l.withCtx)((function(){return[j]})),_:1})]})),_:1},8,["accept","on-change","before-upload","on-progress","on-success","on-error","http-request"]),Object(l.createElementVNode)("span",g,[h,Object(l.createTextVNode)("大小不超过"+Object(l.toDisplayString)(c.maxSize)+"MB",1)])])),Object(l.createElementVNode)("div",k,[Object(l.createVNode)(A,{modelValue:q.keyword,"onUpdate:modelValue":t[0]||(t[0]=function(e){return q.keyword=e}),"prefix-icon":"el-icon-search",placeholder:"文件名搜索",clearable:"",onKeyup:Object(l.withKeys)(R.search,["enter"]),onClear:R.search},null,8,["modelValue","onKeyup","onClear"])])]),Object(l.createElementVNode)("div",v,[Object(l.createVNode)(M,{ref:"scrollbar"},{default:Object(l.withCtx)((function(){return[0==q.fileList.length&&0==q.data.length?(Object(l.openBlock)(),Object(l.createBlock)(F,{key:0,description:"无数据","image-size":80})):Object(l.createCommentVNode)("",!0),(Object(l.openBlock)(!0),Object(l.createElementBlock)(l.Fragment,null,Object(l.renderList)(q.fileList,(function(e,t){return Object(l.openBlock)(),Object(l.createElementBlock)("div",{key:t,class:"sc-file-select__item"},[Object(l.createElementVNode)("div",y,[Object(l.createElementVNode)("div",_,[Object(l.createVNode)(J,{type:"circle",percentage:e.progress,width:70},null,8,["percentage"])]),Object(l.createVNode)(K,{src:e.tempImg,fit:"contain"},null,8,["src"])]),Object(l.createElementVNode)("p",null,Object(l.toDisplayString)(e.name),1)])})),128)),(Object(l.openBlock)(!0),Object(l.createElementBlock)(l.Fragment,null,Object(l.renderList)(q.data,(function(e){return Object(l.openBlock)(),Object(l.createElementBlock)("div",{key:e[q.fileProps.key],class:Object(l.normalizeClass)(["sc-file-select__item",{active:q.value.includes(e[q.fileProps.url])}]),onClick:function(t){return R.select(e)}},[Object(l.createElementVNode)("div",x,[c.multiple?(Object(l.openBlock)(),Object(l.createElementBlock)("div",V,C)):(Object(l.openBlock)(),Object(l.createElementBlock)("div",E,w)),P,R._isImg(e[q.fileProps.url])?(Object(l.openBlock)(),Object(l.createBlock)(K,{key:2,src:e[q.fileProps.url],fit:"contain",lazy:""},null,8,["src"])):(Object(l.openBlock)(),Object(l.createElementBlock)("div",B,[q.files[R._getExt(e[q.fileProps.url])]?(Object(l.openBlock)(),Object(l.createElementBlock)("i",{key:0,class:Object(l.normalizeClass)(q.files[R._getExt(e[q.fileProps.url])].icon),style:Object(l.normalizeStyle)({color:q.files[R._getExt(e[q.fileProps.url])].color})},null,6)):(Object(l.openBlock)(),Object(l.createElementBlock)("i",S))]))]),Object(l.createElementVNode)("p",{title:e[q.fileProps.fileName]},Object(l.toDisplayString)(e[q.fileProps.fileName]),9,z)],10,N)})),128))]})),_:1},512)]),Object(l.createElementVNode)("div",D,[Object(l.createVNode)(G,{small:"",background:"",layout:"prev, pager, next",total:q.total,"page-size":q.pageSize,currentPage:q.currentPage,"onUpdate:currentPage":t[1]||(t[1]=function(e){return q.currentPage=e}),onCurrentChange:R.reload},null,8,["total","page-size","currentPage","onCurrentChange"])]),Object(l.createElementVNode)("div",I,[Object(l.renderSlot)(e.$slots,"do",{},void 0,!0),Object(l.createVNode)(U,{type:"primary",disabled:q.value.length<=0,onClick:R.submit},{default:Object(l.withCtx)((function(){return[L]})),_:1},8,["disabled","onClick"])])],512),[[H,q.listLoading]])])}],["__scopeId","data-v-c1c1a498"]]);t.default=F},a1bd:function(e,t,c){},adcb:function(e,t,c){"use strict";c("a1bd")}}]);