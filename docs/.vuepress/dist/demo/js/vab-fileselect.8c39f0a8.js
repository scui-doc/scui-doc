(window.webpackJsonp=window.webpackJsonp||[]).push([["vab-fileselect"],{"34ce":function(e,t,c){},a651:function(e,t,c){"use strict";c.r(t);var l=c("7a23"),o=Object(l.createTextVNode)("自定义插槽"),n=Object(l.createTextVNode)("切换multiple"),i=Object(l.createTextVNode)("切换hideUpload");c("ac1f"),c("841c"),c("b0c0"),c("caad"),c("2532");var a=function(e){return Object(l.pushScopeId)("data-v-48ded1ad"),e=e(),Object(l.popScopeId)(),e},r={class:"sc-file-select"},s={class:"sc-file-select__side"},u={class:"sc-file-select__side-menu"},d={class:"el-tree-node__label"},p={key:0,class:"sc-file-select__side-msg"},b=Object(l.createTextVNode)(" 已选择 "),f=Object(l.createTextVNode)(" / "),m=Object(l.createTextVNode)(" 项 "),O={class:"sc-file-select__files"},j={class:"sc-file-select__top"},g={key:0,class:"upload"},h=Object(l.createTextVNode)("本地上传"),v={class:"tips"},k={class:"keyword"},_={class:"sc-file-select__list"},N={class:"sc-file-select__item__file"},y={class:"sc-file-select__item__upload"},C=["onClick"],x={class:"sc-file-select__item__file"},V={key:0,class:"sc-file-select__item__checkbox"},w={key:1,class:"sc-file-select__item__select"},B=a((function(){return Object(l.createElementVNode)("div",{class:"sc-file-select__item__box"},null,-1)})),P={key:3,class:"item-file item-file-doc"},E={key:1,class:"sc-icon-file-list-fill",style:{color:"#999"}},S=["title"],z={class:"sc-file-select__pagination"},D={class:"sc-file-select__do"},I=Object(l.createTextVNode)("确 定");var L=c("ade3"),U=c("c7eb"),T=c("1da1"),q=(c("a9e3"),c("e9c4"),c("a434"),c("c740"),c("d3b7"),c("3ca3"),c("ddb0"),c("2b3d"),c("9861"),c("b680"),c("365c")),F={apiObj:q.a.common.upload,menuApiObj:q.a.common.file.menu,listApiObj:q.a.common.file.list,successCode:200,maxSize:30,max:99,uploadParseData:function(e){return{id:e.data.id,fileName:e.data.fileName,url:e.data.src}},listParseData:function(e){return{rows:e.data.rows,total:e.data.total,msg:e.message,code:e.code}},request:{page:"page",pageSize:"pageSize",keyword:"keyword",menuKey:"groupId"},menuProps:{key:"id",label:"label",children:"children"},fileProps:{key:"id",fileName:"fileName",url:"url"},files:{doc:{icon:"sc-icon-file-word-2-fill",color:"#409eff"},docx:{icon:"sc-icon-file-word-2-fill",color:"#409eff"},xls:{icon:"sc-icon-file-excel-2-fill",color:"#67C23A"},xlsx:{icon:"sc-icon-file-excel-2-fill",color:"#67C23A"},ppt:{icon:"sc-icon-file-ppt-2-fill",color:"#F56C6C"},pptx:{icon:"sc-icon-file-ppt-2-fill",color:"#F56C6C"}}},$={props:{modelValue:null,hideUpload:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},max:{type:Number,default:F.max},onlyImage:{type:Boolean,default:!1},maxSize:{type:Number,default:F.maxSize}},data:function(){return{keyword:null,pageSize:20,total:0,currentPage:1,data:[],menu:[],menuId:"",value:this.multiple?[]:"",fileList:[],accept:this.onlyImage?"image/gif, image/jpeg, image/png":"",listLoading:!1,menuLoading:!1,treeProps:F.menuProps,fileProps:F.fileProps,files:F.files}},watch:{multiple:function(){this.value=this.multiple?[]:"",this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.value)))}},mounted:function(){this.getMenu(),this.getData()},methods:{getMenu:function(){var e=this;return Object(T.a)(Object(U.a)().mark((function t(){var c;return Object(U.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.menuLoading=!0,t.next=3,F.menuApiObj.get();case 3:c=t.sent,e.menu=c.data,e.menuLoading=!1;case 6:case"end":return t.stop()}}),t)})))()},getData:function(){var e=this;return Object(T.a)(Object(U.a)().mark((function t(){var c,l,o,n;return Object(U.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.listLoading=!0,c={},Object(L.a)(c,F.request.menuKey,e.menuId),Object(L.a)(c,F.request.page,e.currentPage),Object(L.a)(c,F.request.pageSize,e.pageSize),Object(L.a)(c,F.request.keyword,e.keyword),l=c,e.onlyImage&&(l.type="image"),t.next=5,F.listApiObj.get(l);case 5:o=t.sent,n=F.listParseData(o),e.data=n.rows,e.total=n.total,e.listLoading=!1,e.$refs.scrollbar.setScrollTop(0);case 11:case"end":return t.stop()}}),t)})))()},groupClick:function(e){this.menuId=e.id,this.currentPage=1,this.keyword=null,this.getData()},reload:function(){this.getData()},search:function(){this.currentPage=1,this.getData()},select:function(e){var t=e[this.fileProps.url];this.multiple?this.value.includes(t)?this.value.splice(this.value.findIndex((function(e){return e==t})),1):this.value.push(t):this.value.includes(t)?this.value="":this.value=t},submit:function(){var e=JSON.parse(JSON.stringify(this.value));this.$emit("update:modelValue",e),this.$emit("submit",e)},uploadChange:function(e,t){e.tempImg=URL.createObjectURL(e.raw),this.fileList=t},uploadBefore:function(e){if(!(e.size/1024/1024<this.maxSize))return this.$message.warning("上传文件大小不能超过 ".concat(this.maxSize,"MB!")),!1},uploadRequest:function(e){var t=F.apiObj,c=new FormData;c.append("file",e.file),c.append([F.request.menuKey],this.menuId),t.post(c,{onUploadProgress:function(t){e.onProgress(t)}}).then((function(t){e.onSuccess(t)})).catch((function(t){e.onError(t)}))},uploadProcess:function(e,t){t.progress=Number((e.loaded/e.total*100).toFixed(2))},uploadSuccess:function(e,t){var c;this.fileList.splice(this.fileList.findIndex((function(e){return e.uid==t.uid})),1);var l=F.uploadParseData(e);this.data.unshift((c={},Object(L.a)(c,this.fileProps.key,l.id),Object(L.a)(c,this.fileProps.fileName,l.fileName),Object(L.a)(c,this.fileProps.url,l.url),c)),this.multiple||(this.value=l.url)},uploadError:function(e){this.$notify.error({title:"上传文件错误",message:e})},_isImg:function(e){var t=e.substring(e.lastIndexOf("."));return-1!=[".jpg",".jpeg",".png",".gif",".bmp"].indexOf(t)},_getExt:function(e){return e.substring(e.lastIndexOf(".")+1)}}},A=(c("b780"),c("6b0d")),J=c.n(A);var K={name:"fileselect",components:{scFileSelect:J()($,[["render",function(e,t,c,o,n,i){var a=Object(l.resolveComponent)("el-icon-folder"),L=Object(l.resolveComponent)("el-icon"),U=Object(l.resolveComponent)("el-tree"),T=Object(l.resolveComponent)("el-button"),q=Object(l.resolveComponent)("el-upload"),F=Object(l.resolveComponent)("el-icon-warning"),$=Object(l.resolveComponent)("el-input"),A=Object(l.resolveComponent)("el-empty"),J=Object(l.resolveComponent)("el-progress"),K=Object(l.resolveComponent)("el-image"),M=Object(l.resolveComponent)("el-icon-check"),R=Object(l.resolveComponent)("el-scrollbar"),G=Object(l.resolveComponent)("el-pagination"),H=Object(l.resolveDirective)("loading");return Object(l.openBlock)(),Object(l.createElementBlock)("div",r,[Object(l.withDirectives)((Object(l.openBlock)(),Object(l.createElementBlock)("div",s,[Object(l.createElementVNode)("div",u,[Object(l.createVNode)(U,{ref:"group",class:"menu",data:n.menu,"node-key":n.treeProps.key,props:n.treeProps,"current-node-key":n.menu.length>0?n.menu[0][n.treeProps.key]:"","highlight-current":"",onNodeClick:i.groupClick},{default:Object(l.withCtx)((function(e){var t=e.node;return[Object(l.createElementVNode)("span",d,[Object(l.createVNode)(L,{class:"icon"},{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(a)]})),_:1}),Object(l.createTextVNode)(Object(l.toDisplayString)(t.label),1)])]})),_:1},8,["data","node-key","props","current-node-key","onNodeClick"])]),c.multiple?(Object(l.openBlock)(),Object(l.createElementBlock)("div",p,[b,Object(l.createElementVNode)("b",null,Object(l.toDisplayString)(n.value.length),1),f,Object(l.createElementVNode)("b",null,Object(l.toDisplayString)(c.max),1),m])):Object(l.createCommentVNode)("",!0)])),[[H,n.menuLoading]]),Object(l.withDirectives)((Object(l.openBlock)(),Object(l.createElementBlock)("div",O,[Object(l.createElementVNode)("div",j,[c.hideUpload?Object(l.createCommentVNode)("",!0):(Object(l.openBlock)(),Object(l.createElementBlock)("div",g,[Object(l.createVNode)(q,{class:"sc-file-select__upload",action:"",multiple:"","show-file-list":!1,accept:n.accept,"on-change":i.uploadChange,"before-upload":i.uploadBefore,"on-progress":i.uploadProcess,"on-success":i.uploadSuccess,"on-error":i.uploadError,"http-request":i.uploadRequest},{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(T,{type:"primary",icon:"el-icon-upload"},{default:Object(l.withCtx)((function(){return[h]})),_:1})]})),_:1},8,["accept","on-change","before-upload","on-progress","on-success","on-error","http-request"]),Object(l.createElementVNode)("span",v,[Object(l.createVNode)(L,null,{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(F)]})),_:1}),Object(l.createTextVNode)("大小不超过"+Object(l.toDisplayString)(c.maxSize)+"MB",1)])])),Object(l.createElementVNode)("div",k,[Object(l.createVNode)($,{modelValue:n.keyword,"onUpdate:modelValue":t[0]||(t[0]=function(e){return n.keyword=e}),"prefix-icon":"el-icon-search",placeholder:"文件名搜索",clearable:"",onKeyup:Object(l.withKeys)(i.search,["enter"]),onClear:i.search},null,8,["modelValue","onKeyup","onClear"])])]),Object(l.createElementVNode)("div",_,[Object(l.createVNode)(R,{ref:"scrollbar"},{default:Object(l.withCtx)((function(){return[0==n.fileList.length&&0==n.data.length?(Object(l.openBlock)(),Object(l.createBlock)(A,{key:0,description:"无数据","image-size":80})):Object(l.createCommentVNode)("",!0),(Object(l.openBlock)(!0),Object(l.createElementBlock)(l.Fragment,null,Object(l.renderList)(n.fileList,(function(e,t){return Object(l.openBlock)(),Object(l.createElementBlock)("div",{key:t,class:"sc-file-select__item"},[Object(l.createElementVNode)("div",N,[Object(l.createElementVNode)("div",y,[Object(l.createVNode)(J,{type:"circle",percentage:e.progress,width:70},null,8,["percentage"])]),Object(l.createVNode)(K,{src:e.tempImg,fit:"contain"},null,8,["src"])]),Object(l.createElementVNode)("p",null,Object(l.toDisplayString)(e.name),1)])})),128)),(Object(l.openBlock)(!0),Object(l.createElementBlock)(l.Fragment,null,Object(l.renderList)(n.data,(function(e){return Object(l.openBlock)(),Object(l.createElementBlock)("div",{key:e[n.fileProps.key],class:Object(l.normalizeClass)(["sc-file-select__item",{active:n.value.includes(e[n.fileProps.url])}]),onClick:function(t){return i.select(e)}},[Object(l.createElementVNode)("div",x,[c.multiple?(Object(l.openBlock)(),Object(l.createElementBlock)("div",V,[Object(l.createVNode)(L,null,{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(M)]})),_:1})])):(Object(l.openBlock)(),Object(l.createElementBlock)("div",w,[Object(l.createVNode)(L,null,{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(M)]})),_:1})])),B,i._isImg(e[n.fileProps.url])?(Object(l.openBlock)(),Object(l.createBlock)(K,{key:2,src:e[n.fileProps.url],fit:"contain",lazy:""},null,8,["src"])):(Object(l.openBlock)(),Object(l.createElementBlock)("div",P,[n.files[i._getExt(e[n.fileProps.url])]?(Object(l.openBlock)(),Object(l.createElementBlock)("i",{key:0,class:Object(l.normalizeClass)(n.files[i._getExt(e[n.fileProps.url])].icon),style:Object(l.normalizeStyle)({color:n.files[i._getExt(e[n.fileProps.url])].color})},null,6)):(Object(l.openBlock)(),Object(l.createElementBlock)("i",E))]))]),Object(l.createElementVNode)("p",{title:e[n.fileProps.fileName]},Object(l.toDisplayString)(e[n.fileProps.fileName]),9,S)],10,C)})),128))]})),_:1},512)]),Object(l.createElementVNode)("div",z,[Object(l.createVNode)(G,{small:"",background:"",layout:"prev, pager, next",total:n.total,"page-size":n.pageSize,currentPage:n.currentPage,"onUpdate:currentPage":t[1]||(t[1]=function(e){return n.currentPage=e}),onCurrentChange:i.reload},null,8,["total","page-size","currentPage","onCurrentChange"])]),Object(l.createElementVNode)("div",D,[Object(l.renderSlot)(e.$slots,"do",{},void 0,!0),Object(l.createVNode)(T,{type:"primary",disabled:n.value.length<=0,onClick:i.submit},{default:Object(l.withCtx)((function(){return[I]})),_:1},8,["disabled","onClick"])])])),[[H,n.listLoading]])])}],["__scopeId","data-v-48ded1ad"]])},data:function(){return{file:"",multiple:!1,hideUpload:!1,upload:"",upload2:""}},mounted:function(){},methods:{submit:function(e){console.log(e),this.$message("返回值请查看F12控制台console.log()")}}};const M=J()(K,[["render",function(e,t,c,a,r,s){var u=Object(l.resolveComponent)("el-alert"),d=Object(l.resolveComponent)("el-button"),p=Object(l.resolveComponent)("sc-file-select"),b=Object(l.resolveComponent)("el-card"),f=Object(l.resolveComponent)("el-col"),m=Object(l.resolveComponent)("el-row"),O=Object(l.resolveComponent)("el-main");return Object(l.openBlock)(),Object(l.createBlock)(O,null,{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(m,{gutter:15},{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(f,{lg:18},{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(b,{shadow:"never"},{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(u,{title:"资源库选择器即将弃用,将不会维护更新,与1.7版本之后将移除此组件",type:"error",style:{"margin-bottom":"20px"}}),Object(l.createVNode)(p,{modelValue:r.file,"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.file=e}),multiple:r.multiple,hideUpload:r.hideUpload,max:99,onSubmit:s.submit},{do:Object(l.withCtx)((function(){return[Object(l.createVNode)(d,null,{default:Object(l.withCtx)((function(){return[o]})),_:1})]})),_:1},8,["modelValue","multiple","hideUpload","onSubmit"])]})),_:1})]})),_:1}),Object(l.createVNode)(f,{lg:6},{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(b,{shadow:"never",header:"参数和方法"},{default:Object(l.withCtx)((function(){return[Object(l.createVNode)(d,{type:"primary",onClick:t[1]||(t[1]=function(e){return r.multiple=!r.multiple})},{default:Object(l.withCtx)((function(){return[n]})),_:1}),Object(l.createVNode)(d,{type:"primary",onClick:t[2]||(t[2]=function(e){return r.hideUpload=!r.hideUpload})},{default:Object(l.withCtx)((function(){return[i]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1})}]]);t.default=M},b780:function(e,t,c){"use strict";c("34ce")}}]);